const RELEASE="2.1.4";console.log("Signatures v 2.1.4"),document.getElementById("appRelease").innerText="2.1.4";const ITEMS=["name","surname","orgTitle","organisation","email","domain","phone","mobile","pole"],SEPARATOR_COLORS={ADAPEI:"#e6b000",DIOCESE:"#0b4a6d"},DEFAULT_IMG_PATH="img/logos/",POLES_ARRAY=[adapei={lib:"Adapei de la Meuse",color:SEPARATOR_COLORS.ADAPEI,src:"adapei.png"},adapei60={lib:"[60 ans] Adapei de la Meuse",color:SEPARATOR_COLORS.ADAPEI,src:"60ans.jpg"},retroActif={lib:"Les rétro actifs",color:SEPARATOR_COLORS.ADAPEI,src:"retroActif.png"},meuseInsertion={lib:"Meuse Insertion",color:SEPARATOR_COLORS.ADAPEI,src:"meuseInsertion.png"},adultesDependants={lib:"Pôle Adultes Dépendants",color:SEPARATOR_COLORS.ADAPEI,src:"adultesDependants.png"},agricole={lib:"Pôle Agricole",color:SEPARATOR_COLORS.ADAPEI,src:"agricole.png"},enfance={lib:"Pôle Enfance",color:SEPARATOR_COLORS.ADAPEI,src:"enfance.png"},habitat={lib:"Pôle Habitat",color:SEPARATOR_COLORS.ADAPEI,src:"habitat.png"},industriel={lib:"Pôle Industriel",color:SEPARATOR_COLORS.ADAPEI,src:"industriel.png"},mobiMeuse={lib:"Mobi'Meuse",color:SEPARATOR_COLORS.ADAPEI,src:"mobimeuse.png"},abri={lib:"Abri des Pèlerins",color:SEPARATOR_COLORS.ADAPEI,src:"abri.png"},diocese={lib:"Diocèse",color:SEPARATOR_COLORS.DIOCESE,src:"diocese.png",hidden:!0,domaine:"@catholique55.fr"},mda={lib:"Maison des Adolescents",color:SEPARATOR_COLORS.DIOCESE,src:"mda.jpg",hidden:!0,domaine:"@mda55.fr"},amseaa={lib:"AMSEAA",color:SEPARATOR_COLORS.ADAPEI,src:"amseaa.jpg",hidden:!0,domaine:"@amseaa.fr"}];var poleInput=document.getElementById("poleInput"),checkMobileInput=document.getElementById("checkMobileInput"),checkPhoneInput=document.getElementById("checkPhoneInput");function displayNone(liElement){"d-none"===liElement.getAttribute("class")?liElement.setAttribute("class","d-flex align-items-center"):liElement.setAttribute("class","d-none")}function displayInputToOutput(input,output){input.value&&("nameOutput"===output.id||"surnameOutput"===output.id?(output.innerText=input.value,champEmail=document.getElementById("emailInput"),champEmail.value=prenomNomToEmail(document.getElementById("nameInput").value,document.getElementById("surnameInput").value),champEmail.dispatchEvent(new Event("change"))):"IMG"===output.nodeName?(output.src="img/logos/"+POLES_ARRAY[input.value].src,output.crossOrigin="anonymous",setSeparatorBorderColor(document.getElementById("separator"),POLES_ARRAY[input.value].color)):"domainInput"===input.id?(output.innerText=input.value.toLowerCase(),selectPoleFromDomaine(input)):output.innerText=input.value,updateImageOutput())}function updateImageOutput(){window.scrollTo(0,0),html2canvas(document.getElementById("outputCard"),{scale:.85}).then((function(canvas){lien=canvas.toDataURL("image/jpeg"),lienSignature=document.getElementById("lienSignature"),document.getElementById("signatureOutput").src=lien,lienSignature.href=lien,lienSignature.download=document.getElementById("nameInput").value+"_"+document.getElementById("surnameInput").value+".jpg"}))}function setSeparatorBorderColor(separator,color){separator.style.borderColor=color}function selectPoleFromDomaine(input){POLES_ARRAY.forEach((pole,i)=>{input.value===pole.domaine&&selectValue(poleInput,i)})}function addOptionToSelect(select,optionValue,optionText){let option=document.createElement("option");return option.appendChild(document.createTextNode(optionText)),option.value=optionValue,select.appendChild(option),option}function hideOption(option){option.hidden=!0}function selectValue(select,value){select.value=value,select.dispatchEvent(new Event("change"))}function prenomNomToEmail(prenom,nom){return prenom.toLowerCase()[0]+"."+nom.toLowerCase()}document.getElementById("inputForm").addEventListener("submit",e=>e.preventDefault()),POLES_ARRAY.forEach((pole,index)=>{let option=addOptionToSelect(poleInput,index,pole.lib);pole.hidden&&hideOption(option)}),ITEMS.forEach(item=>{let input=item+"Input",output=item+"Output";document.getElementById(input).addEventListener("change",e=>displayInputToOutput(e.target,document.getElementById(output)))}),checkMobileInput.addEventListener("change",(function(){displayNone(document.getElementById("liMobile")),updateImageOutput()})),checkPhoneInput.addEventListener("change",(function(){displayNone(document.getElementById("liPhone")),updateImageOutput()}));